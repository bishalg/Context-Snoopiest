---
// Workflow Pipeline Step Component
interface Props {
  step: string;
  title: string;
  phase: string;
  input: string;
  action: string;
  output: string | string[];
  color: string;
  align?: 'left' | 'right' | 'center';
}

const { step, title, phase, input, action, output, color, align = 'left' } = Astro.props;

const colorMap = {
  amber: 'border-amber-500 bg-amber-500',
  sky: 'border-sky-500 bg-sky-500',
  teal: 'border-teal-500 bg-teal-500',
  indigo: 'border-indigo-500 bg-indigo-500',
  emerald: 'border-emerald-500 bg-emerald-500',
};

const borderColor = colorMap[color].split(' ')[0];
const badgeColor = colorMap[color].split(' ')[1];
const textColor = `text-${color}-600 dark:text-${color}-400`;

const alignClass = align === 'right' ? 'justify-end' : align === 'center' ? 'justify-center' : 'justify-start';
const cardWidth = align === 'center' ? 'w-full md:w-6/12' : 'w-full md:w-10/12';
---

<div class={`flex ${alignClass} my-8 not-prose font-sans`}>
    <div class={`${cardWidth} step-card border-l-4 ${borderColor} bg-white dark:bg-slate-900 shadow-xl rounded-xl p-6 relative transition-all hover:-translate-y-1`}>
        <div class={`${badgeColor} text-white w-8 h-8 rounded-full flex items-center justify-center font-bold absolute -top-4 -left-4 shadow-lg`}>
            {step}
        </div>
        <h3 class="font-bold text-slate-800 dark:text-white text-lg">{title}</h3>
        <div class={`text-xs font-bold uppercase mb-4 ${textColor}`}>{phase}</div>
        
        <div class="space-y-4">
            <div class="flex items-start gap-4">
                <span class="text-[10px] font-black text-slate-400 uppercase w-12 mt-1 shrink-0">Input</span>
                <div class="text-sm dark:text-slate-300">{input}</div>
            </div>
            <div class="flex items-start gap-4">
                <span class="text-[10px] font-black text-slate-400 uppercase w-12 mt-1 shrink-0">Action</span>
                <div class="text-sm dark:text-slate-300">{action}</div>
            </div>
            <div class="flex items-center gap-4">
                <span class="text-[10px] font-black text-slate-400 uppercase w-12 shrink-0">Output</span>
                <div class="flex flex-wrap gap-2">
                    {Array.isArray(output) ? output.map(o => (
                        <span class="json-pill text-[10px] bg-slate-100 dark:bg-white/5 border border-slate-200 dark:border-white/10 px-2 py-1 rounded font-mono">{o}</span>
                    )) : (
                        <span class="json-pill text-[10px] bg-slate-100 dark:bg-white/5 border border-slate-200 dark:border-white/10 px-2 py-1 rounded font-mono">{output}</span>
                    )}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .step-card {
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
</style>
