---
// Metrics comparison charts
---

<div
  class="grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-12 not-prose my-8 sm:my-12"
>
  <!-- Chart 1: Parallel Efficiency -->
  <div
    class="bg-white dark:bg-slate-900 p-4 sm:p-8 rounded-xl sm:rounded-3xl shadow-lg border border-slate-100 dark:border-white/5 flex flex-col"
  >
    <h3 class="font-bold text-slate-800 dark:text-white mb-4 text-xl">
      Time Efficiency
    </h3>
    <div
      class="chart-container relative h-[180px] sm:h-[220px] md:h-[250px] w-full mb-4 sm:mb-6"
    >
      <canvas id="efficiencyChart"></canvas>
    </div>
    <div class="mt-auto">
      <h4
        class="text-sm font-bold text-teal-600 dark:text-teal-400 mb-2 uppercase tracking-wider"
      >
        How it works
      </h4>
      <p class="text-sm text-slate-600 dark:text-slate-400 leading-relaxed">
        In a linear pipeline, text processing blocks asset generation. The
        Agentic Swarm decouples these tasks. The <strong>Art Department</strong> begins
        generating character LoRAs and location baselines the moment the <strong
          >Showrunner</strong
        > identifies them, running <em>concurrently</em> with the Writers' Room narrative
        analysis. This parallelization reduces total end-to-end latency by approximately
        <strong>60%</strong> compared to sequential processing.
      </p>
    </div>
  </div>

  <!-- Chart 2: Cost Saving via Critique -->
  <div
    class="bg-white dark:bg-slate-900 p-4 sm:p-8 rounded-xl sm:rounded-3xl shadow-lg border border-slate-100 dark:border-white/5 flex flex-col"
  >
    <h3 class="font-bold text-slate-800 dark:text-white mb-4 text-xl">
      Cost Optimization
    </h3>
    <div
      class="chart-container relative h-[180px] sm:h-[220px] md:h-[250px] w-full mb-4 sm:mb-6"
    >
      <canvas id="costChart"></canvas>
    </div>
    <div class="mt-auto">
      <h4
        class="text-sm font-bold text-pink-600 dark:text-pink-400 mb-2 uppercase tracking-wider"
      >
        How it works
      </h4>
      <p class="text-sm text-slate-600 dark:text-slate-400 leading-relaxed">
        Video generation models are expensive (up to $0.10 per second). Standard
        pipelines often render "hallucinated" content (e.g., wrong clothing)
        that must be discarded. The <strong>QA Critic</strong> intercepts the Director's
        prompt <em>before</em> it hits the Video API. By rejecting invalid prompts
        cheaply at the text level, we reduce wasted render costs from ~40% to less
        than <strong>5%</strong>.
      </p>
    </div>
  </div>
</div>

<script>
  import Chart from "chart.js/auto";

  // Chart Defaults
  Chart.defaults.font.family = "'Inter', sans-serif";
  Chart.defaults.color = "#64748B";

  // Initialize charts on load
  document.addEventListener("DOMContentLoaded", () => {
    // --- CHART 1: EFFICIENCY ---
    const ctx1 = document.getElementById(
      "efficiencyChart",
    ) as HTMLCanvasElement;
    if (ctx1) {
      new Chart(ctx1, {
        type: "bar",
        data: {
          labels: ["Linear Pipeline", "Agentic Swarm"],
          datasets: [
            {
              label: "Text Processing",
              data: [50, 20],
              backgroundColor: "#0F766E", // Teal
            },
            {
              label: "Asset Generation",
              data: [40, 20],
              backgroundColor: "#D97706", // Amber
            },
            {
              label: "Video Rendering",
              data: [60, 60],
              backgroundColor: "#0EA5E9", // Sky
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: "y",
          scales: {
            x: {
              stacked: true,
              title: {
                display: true,
                text: "Total Production Time (Minutes)",
              },
              grid: { color: "rgba(148, 163, 184, 0.1)" },
            },
            y: {
              stacked: true,
              grid: { display: false },
            },
          },
          plugins: {
            legend: { position: "bottom" },
            tooltip: {
              backgroundColor: "rgba(15, 23, 42, 0.9)",
              padding: 12,
              cornerRadius: 8,
            },
          },
          animation: {
            duration: 2000,
            easing: "easeOutQuart",
          },
        },
      });
    }

    // --- CHART 2: COST / QUALITY ---
    const ctx2 = document.getElementById("costChart") as HTMLCanvasElement;
    if (ctx2) {
      new Chart(ctx2, {
        type: "bar",
        data: {
          labels: ["Linear Pipeline", "Agentic Swarm"],
          datasets: [
            {
              label: "Wasted Renders",
              data: [35, 5],
              backgroundColor: "#EF4444", // Red
            },
            {
              label: "Successful Renders",
              data: [65, 95],
              backgroundColor: "#22C55E", // Green
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: "% of Total Generation Cost",
              },
              grid: { color: "rgba(148, 163, 184, 0.1)" },
            },
            x: {
              grid: { display: false },
            },
          },
          plugins: {
            legend: { position: "bottom" },
            tooltip: {
              backgroundColor: "rgba(15, 23, 42, 0.9)",
              padding: 12,
              cornerRadius: 8,
            },
          },
          animation: {
            duration: 2000,
            easing: "easeOutQuart",
            delay: 500, // Start after the first chart
          },
        },
      });
    }
  });
</script>
